<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital Labour ‚Ä¢ Cyberpunk Terminal</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron: wght@400;700;900&display=swap" rel="stylesheet">
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'cyber-cyan': '#00f0ff',
            'cyber-magenta': '#ff00d0',
            'cyber-yellow': '#ffd166',
            'cyber-dark':  '#020617',
            'cyber-darker': '#0a0a0f',
          },
          fontFamily: {
            'terminal': ['"Share Tech Mono"', 'monospace'],
            'cyber':  ['Orbitron', 'sans-serif'],
          },
          animation: {
            'blink': 'blink 1.4s infinite',
            'glow': 'glow 2s ease-in-out infinite',
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'scanline': 'scanline 8s linear infinite',
          },
          keyframes: {
            blink: {
              '0%, 49%': { opacity: '1' },
              '50%, 100%': { opacity: '0. 3' },
            },
            glow: {
              '0%, 100%': { 
                boxShadow: '0 0 20px rgba(0, 240, 255, 0.3), 0 0 40px rgba(0, 240, 255, 0.1), inset 0 0 20px rgba(0, 240, 255, 0.05)' 
              },
              '50%': { 
                boxShadow: '0 0 30px rgba(0, 240, 255, 0.6), 0 0 60px rgba(0, 240, 255, 0.3), inset 0 0 30px rgba(0, 240, 255, 0.1)' 
              },
            },
            scanline: {
              '0%': { transform: 'translateY(-100%)' },
              '100%': { transform: 'translateY(100%)' },
            },
          },
        },
      },
    }
  </script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Share Tech Mono', monospace;
      background: #0a0a0f;
      color: #00f0ff;
      overflow-x: hidden;
      position: relative;
    }

    /* Space background canvas */
    #space-canvas {
      position:  fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    /* Matrix effect canvas */
    #matrix-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height:  100%;
      z-index: 1;
      pointer-events: none;
      opacity: 0.15;
    }

    /* Scanline effect */
    . scanline {
      position: fixed;
      top: 0;
      left: 0;
      width:  100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 240, 255, 0.03) 0px,
        transparent 1px,
        transparent 2px,
        rgba(0, 240, 255, 0.03) 3px
      );
      pointer-events:  none;
      z-index:  2;
    }

    . scanline::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 20px;
      background: linear-gradient(
        to bottom,
        rgba(0, 240, 255, 0.1),
        transparent
      );
      animation: scanline 8s linear infinite;
    }

    /* Glass morphism */
    .glass-panel {
      background: rgba(10, 10, 15, 0.7);
      backdrop-filter: blur(16px) saturate(180%);
      border: 1px solid rgba(0, 240, 255, 0.2);
      box-shadow: 0 8px 32px 0 rgba(0, 240, 255, 0.1),
                  inset 0 0 20px rgba(0, 240, 255, 0.03);
    }

    /* Glow text */
    .glow-text {
      text-shadow: 0 0 10px rgba(0, 240, 255, 0.8),
                   0 0 20px rgba(0, 240, 255, 0.4),
                   0 0 30px rgba(0, 240, 255, 0.2);
    }

    . glow-text-magenta {
      text-shadow:  0 0 10px rgba(255, 0, 208, 0.8),
                   0 0 20px rgba(255, 0, 208, 0.4),
                   0 0 30px rgba(255, 0, 208, 0.2);
    }

    /* Neon border */
    .neon-border {
      position: relative;
    }

    .neon-border::before {
      content: '';
      position: absolute;
      inset: -2px;
      background: linear-gradient(45deg, #00f0ff, #ff00d0, #ffd166, #00f0ff);
      border-radius: inherit;
      opacity: 0.5;
      z-index: -1;
      filter: blur(8px);
      animation: glow 2s ease-in-out infinite;
    }

    /* Custom scrollbar */
    : :-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background:  rgba(0, 240, 255, 0.05);
    }

    ::-webkit-scrollbar-thumb {
      background:  rgba(0, 240, 255, 0.3);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 240, 255, 0.5);
    }

    /* Hover effects */
    .cyber-button {
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .cyber-button:: before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background:  rgba(0, 240, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .cyber-button:hover::before {
      width: 300px;
      height: 300px;
    }

    .cyber-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 20px rgba(0, 240, 255, 0.6);
    }

    /* Tab animation */
    .tab {
      position: relative;
      transition: all 0.3s ease;
    }

    .tab::after {
      content: '';
      position: absolute;
      bottom:  0;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, #00f0ff, #ff00d0);
      transition: width 0.3s ease;
    }

    .tab:hover::after,
    .tab.active::after {
      width: 100%;
    }

    /* Terminal cursor */
    .terminal-cursor {
      display: inline-block;
      width: 10px;
      height: 18px;
      background: #00f0ff;
      animation: blink 1s step-end infinite;
      margin-left: 2px;
    }

    /* Loading spinner */
    .loading-spinner {
      border: 3px solid rgba(0, 240, 255, 0.1);
      border-top: 3px solid #00f0ff;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive container */
    .content-wrapper {
      position: relative;
      z-index: 10;
    }

    /* Status dot pulse */
    .status-dot {
      animation: pulse-slow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse-slow {
      0%, 100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.7;
        transform: scale(1.1);
      }
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- Space background canvas -->
  <canvas id="space-canvas"></canvas>
  
  <!-- Matrix effect canvas -->
  <canvas id="matrix-canvas"></canvas>
  
  <!-- Scanline overlay -->
  <div class="scanline"></div>

  <!-- Main content -->
  <div class="content-wrapper min-h-screen p-4 md:p-8">
    <!-- Header -->
    <header class="glass-panel rounded-2xl p-6 md:p-8 mb-6 neon-border">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="flex items-center gap-4">
          <div class="w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-cyber-cyan to-cyber-magenta rounded-xl flex items-center justify-center text-2xl md:text-3xl font-cyber font-black text-cyber-darker shadow-lg">
            DL
          </div>
          <div>
            <h1 class="text-2xl md:text-4xl font-cyber font-black glow-text animate-blink">
              DIGITAL LABOUR AI AGENT
            </h1>
            <p class="text-sm md:text-base text-cyan-300 font-terminal mt-1">
              >> Automated Holiday & Announcement System_<span class="terminal-cursor"></span>
            </p>
          </div>
        </div>
        
        <div class="flex items-center gap-3">
          <div class="flex items-center gap-2 glass-panel px-4 py-2 rounded-full border border-cyber-cyan/30">
            <div class="w-3 h-3 bg-cyber-cyan rounded-full status-dot"></div>
            <span class="text-cyber-cyan font-terminal text-sm" id="status-text">RUNNING</span>
          </div>
          <div class="glass-panel px-4 py-2 rounded-full border border-cyber-magenta/30">
            <span class="text-cyber-magenta font-terminal text-sm" id="timezone-text">TZ:  LOADING... </span>
          </div>
        </div>
      </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="glass-panel rounded-xl p-2 mb-6 flex flex-wrap gap-2" role="tablist">
      <button 
        class="tab active flex-1 min-w-[120px] px-4 py-3 rounded-lg font-terminal text-sm md:text-base hover:bg-cyber-cyan/10 transition-all focus:outline-none focus:ring-2 focus:ring-cyber-cyan"
        role="tab"
        aria-selected="true"
        aria-controls="overview-panel"
        tabindex="0"
        onclick="handleTabClick('overview', this)"
        onkeydown="handleKeyDown(event, () => handleTabClick('overview', this))"
      >
        <span class="glow-text">üìä OVERVIEW</span>
      </button>
      <button 
        class="tab flex-1 min-w-[120px] px-4 py-3 rounded-lg font-terminal text-sm md:text-base hover:bg-cyber-cyan/10 transition-all focus:outline-none focus:ring-2 focus:ring-cyber-cyan"
        role="tab"
        aria-selected="false"
        aria-controls="holidays-panel"
        tabindex="0"
        onclick="handleTabClick('holidays', this)"
        onkeydown="handleKeyDown(event, () => handleTabClick('holidays', this))"
      >
        üéâ HOLIDAYS
      </button>
      <button 
        class="tab flex-1 min-w-[120px] px-4 py-3 rounded-lg font-terminal text-sm md:text-base hover: bg-cyber-cyan/10 transition-all focus:outline-none focus:ring-2 focus: ring-cyber-cyan"
        role="tab"
        aria-selected="false"
        aria-controls="custom-panel"
        tabindex="0"
        onclick="handleTabClick('custom', this)"
        onkeydown="handleKeyDown(event, () => handleTabClick('custom', this))"
      >
        üì¢ CUSTOM
      </button>
      <button 
        class="tab flex-1 min-w-[120px] px-4 py-3 rounded-lg font-terminal text-sm md:text-base hover:bg-cyber-cyan/10 transition-all focus:outline-none focus: ring-2 focus:ring-cyber-cyan"
        role="tab"
        aria-selected="false"
        aria-controls="scheduled-panel"
        tabindex="0"
        onclick="handleTabClick('scheduled', this)"
        onkeydown="handleKeyDown(event, () => handleTabClick('scheduled', this))"
      >
        ‚è∞ SCHEDULED
      </button>
      <button 
        class="tab flex-1 min-w-[120px] px-4 py-3 rounded-lg font-terminal text-sm md:text-base hover:bg-cyber-cyan/10 transition-all focus:outline-none focus:ring-2 focus:ring-cyber-cyan"
        role="tab"
        aria-selected="false"
        aria-controls="logs-panel"
        tabindex="0"
        onclick="handleTabClick('logs', this)"
        onkeydown="handleKeyDown(event, () => handleTabClick('logs', this))"
      >
        üìã LOGS
      </button>
    </nav>

    <!-- Tab Panels -->
    <div class="space-y-6">
      <!-- Overview Panel -->
      <div id="overview-panel" class="tab-panel" role="tabpanel" aria-labelledby="overview-tab">
        <!-- Stats Grid -->
        <div class="grid grid-cols-1 md: grid-cols-3 gap-4 mb-6">
          <!-- Holiday Announcements -->
          <div class="glass-panel rounded-xl p-6 neon-border hover:scale-105 transition-transform">
            <div class="flex items-center justify-between mb-4">
              <span class="text-cyber-cyan font-terminal text-sm">HOLIDAY_ANNOUNCEMENTS</span>
              <span class="text-2xl">üéä</span>
            </div>
            <div class="text-5xl font-cyber font-black glow-text mb-2" id="holiday-count">0</div>
            <div class="text-xs text-cyan-300/60 font-terminal">TOTAL_SENT</div>
          </div>

          <!-- Custom Announcements -->
          <div class="glass-panel rounded-xl p-6 neon-border hover:scale-105 transition-transform">
            <div class="flex items-center justify-between mb-4">
              <span class="text-cyber-magenta font-terminal text-sm">CUSTOM_ANNOUNCEMENTS</span>
              <span class="text-2xl">üì£</span>
            </div>
            <div class="text-5xl font-cyber font-black glow-text-magenta mb-2" id="custom-count">0</div>
            <div class="text-xs text-magenta-300/60 font-terminal">TOTAL_SENT</div>
          </div>

          <!-- Scheduled Items -->
          <div class="glass-panel rounded-xl p-6 neon-border hover:scale-105 transition-transform">
            <div class="flex items-center justify-between mb-4">
              <span class="text-cyber-yellow font-terminal text-sm">SCHEDULED_ITEMS</span>
              <span class="text-2xl">‚è±Ô∏è</span>
            </div>
            <div class="text-5xl font-cyber font-black text-cyber-yellow mb-2" id="scheduled-count">0</div>
            <div class="text-xs text-yellow-300/60 font-terminal">IN_QUEUE</div>
          </div>
        </div>

        <!-- Today's Holiday -->
        <div class="glass-panel rounded-xl p-6 mb-6">
          <h2 class="text-xl font-cyber font-bold glow-text mb-4 flex items-center gap-2">
            <span class="animate-pulse">üìÖ</span> TODAY'S HOLIDAY
          </h2>
          <div id="today-holiday" class="font-terminal">
            <div class="animate-pulse">LOADING...</div>
          </div>
        </div>

        <!-- Upcoming Holidays -->
        <div class="glass-panel rounded-xl p-6">
          <h2 class="text-xl font-cyber font-bold glow-text mb-4 flex items-center gap-2">
            <span class="animate-bounce">üîÆ</span> UPCOMING HOLIDAYS
          </h2>
          <div id="upcoming-holidays" class="space-y-3 max-h-96 overflow-y-auto font-terminal">
            <div class="animate-pulse">LOADING...</div>
          </div>
        </div>
      </div>

      <!-- Holidays Panel -->
      <div id="holidays-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="holidays-tab">
        <div class="glass-panel rounded-xl p-6">
          <h2 class="text-2xl font-cyber font-bold glow-text mb-6">HOLIDAY AUTOMATION</h2>
          <div class="space-y-4">
            <div class="p-4 bg-cyber-cyan/5 rounded-lg border border-cyber-cyan/20">
              <div class="flex items-center justify-between mb-2">
                <span class="font-terminal text-cyber-cyan">NEXT_CHECK</span>
                <span class="font-terminal text-sm" id="next-check-time">Daily at 00:00 IST</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="font-terminal text-cyber-cyan">LAST_RUN</span>
                <span class="font-terminal text-sm" id="last-run-date">‚Äî</span>
              </div>
            </div>

            <div class="flex flex-wrap gap-3">
              <button 
                class="cyber-button glass-panel px-6 py-3 rounded-lg border border-cyber-cyan/50 hover:border-cyber-cyan font-terminal transition-all focus:outline-none focus:ring-2 focus:ring-cyber-cyan"
                onclick="handleTriggerHoliday(this)"
                onkeydown="handleKeyDown(event, () => handleTriggerHoliday(this))"
                tabindex="0"
                aria-label="Trigger holiday check manually"
              >
                üöÄ TRIGGER_NOW
              </button>
              <button 
                class="cyber-button glass-panel px-6 py-3 rounded-lg border border-cyber-magenta/50 hover:border-cyber-magenta font-terminal transition-all focus:outline-none focus:ring-2 focus:ring-cyber-magenta"
                onclick="handleTestNewYear(this)"
                onkeydown="handleKeyDown(event, () => handleTestNewYear(this))"
                tabindex="0"
                aria-label="Test New Year announcement"
              >
                üéâ TEST_NEW_YEAR
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Custom Panel -->
      <div id="custom-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="custom-tab">
        <div class="glass-panel rounded-xl p-6">
          <h2 class="text-2xl font-cyber font-bold glow-text mb-6">CUSTOM ANNOUNCEMENTS</h2>
          <p class="font-terminal text-cyan-300/60">Custom announcement functionality available via API at <code class="text-cyber-cyan">/api/announcement/send</code></p>
        </div>
      </div>

      <!-- Scheduled Panel -->
      <div id="scheduled-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="scheduled-tab">
        <div class="glass-panel rounded-xl p-6">
          <h2 class="text-2xl font-cyber font-bold glow-text mb-6">SCHEDULED ITEMS</h2>
          <div id="scheduled-list" class="space-y-3 font-terminal">
            <div class="animate-pulse">LOADING... </div>
          </div>
        </div>
      </div>

      <!-- Logs Panel -->
      <div id="logs-panel" class="tab-panel hidden" role="tabpanel" aria-labelledby="logs-tab">
        <div class="glass-panel rounded-xl p-6">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-2xl font-cyber font-bold glow-text">ACTIVITY LOGS</h2>
            <button 
              class="cyber-button glass-panel px-4 py-2 rounded-lg border border-cyber-cyan/50 hover:border-cyber-cyan font-terminal text-sm transition-all focus:outline-none focus:ring-2 focus:ring-cyber-cyan"
              onclick="handleRefreshLogs()"
              onkeydown="handleKeyDown(event, handleRefreshLogs)"
              tabindex="0"
              aria-label="Refresh activity logs"
            >
              üîÑ REFRESH
            </button>
          </div>
          <div id="logs-container" class="bg-cyber-darker/50 rounded-lg p-4 max-h-[600px] overflow-y-auto border border-cyber-cyan/20 font-terminal text-sm">
            <div class="animate-pulse text-cyber-cyan">LOADING LOGS...</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="mt-8 text-center font-terminal text-xs text-cyan-300/40">
      <p>DIGITAL_LABOUR ¬© 2026 ‚Ä¢ POWERED_BY_NODE. JS + EXPRESS + GEMINI_AI</p>
      <p class="mt-1">TRIPLE_REDUNDANCY:  CRON + MINUTE_GUARD + EXTERNAL_TRIGGER</p>
    </footer>
  </div>

  <script>
    // ==================== CANVAS ANIMATIONS ====================
    
    // Space background with stars
    const initSpaceCanvas = () => {
      const canvas = document.getElementById('space-canvas');
      const ctx = canvas.getContext('2d');
      
      const resizeCanvas = () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      };
      
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);
      
      const stars = [];
      const starCount = 200;
      
      for (let i = 0; i < starCount; i++) {
        stars.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          radius: Math.random() * 2,
          speed: Math.random() * 0.5 + 0.1,
          opacity: Math.random(),
          opacityDirection: Math.random() > 0.5 ? 1 : -1,
        });
      }
      
      const animateStars = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Nebula gradient
        const gradient = ctx.createRadialGradient(
          canvas.width / 2, canvas. height / 2, 0,
          canvas.width / 2, canvas.height / 2, canvas.width / 2
        );
        gradient.addColorStop(0, 'rgba(0, 240, 255, 0.03)');
        gradient.addColorStop(0.5, 'rgba(255, 0, 208, 0.02)');
        gradient.addColorStop(1, 'rgba(10, 10, 15, 0)');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas. height);
        
        // Draw stars
        stars.forEach(star => {
          ctx.beginPath();
          ctx.arc(star.x, star.y, star.radius, 0, Math. PI * 2);
          ctx.fillStyle = `rgba(0, 240, 255, ${star.opacity})`;
          ctx.fill();
          
          // Move stars
          star.y += star.speed;
          if (star.y > canvas.height) {
            star.y = 0;
            star.x = Math.random() * canvas.width;
          }
          
          // Twinkle effect
          star.opacity += star.opacityDirection * 0.02;
          if (star.opacity >= 1 || star.opacity <= 0.2) {
            star.opacityDirection *= -1;
          }
        });
        
        requestAnimationFrame(animateStars);
      };
      
      animateStars();
    };
    
    // Matrix rain effect
    const initMatrixCanvas = () => {
      const canvas = document.getElementById('matrix-canvas');
      const ctx = canvas. getContext('2d');
      
      const resizeCanvas = () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      };
      
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);
      
      const fontSize = 14;
      const columns = canvas.width / fontSize;
      const drops = Array(Math.floor(columns)).fill(1);
      
      const matrixChars = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà';
      
      const animateMatrix = () => {
        ctx.fillStyle = 'rgba(10, 10, 15, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        ctx.fillStyle = '#00f0ff';
        ctx.font = `${fontSize}px "Share Tech Mono"`;
        
        for (let i = 0; i < drops.length; i++) {
          const text = matrixChars[Math.floor(Math.random() * matrixChars.length)];
          const x = i * fontSize;
          const y = drops[i] * fontSize;
          
          ctx.fillText(text, x, y);
          
          if (y > canvas.height && Math.random() > 0.975) {
            drops[i] = 0;
          }
          drops[i]++;
        }
      };
      
      setInterval(animateMatrix, 50);
    };
    
    // ==================== STATE MANAGEMENT ====================
    
    let currentTab = 'overview';
    let appState = {
      status: {},
      todayHoliday: null,
      upcomingHolidays: [],
      scheduledItems: [],
      logs:  [],
    };
    
    // ==================== TAB NAVIGATION ====================
    
    const handleTabClick = (tabName, element) => {
      if (currentTab === tabName) return;
      
      // Update ARIA attributes
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
        tab.setAttribute('aria-selected', 'false');
      });
      
      element.classList.add('active');
      element.setAttribute('aria-selected', 'true');
      
      // Hide all panels
      document.querySelectorAll('.tab-panel').forEach(panel => {
        panel. classList.add('hidden');
      });
      
      // Show selected panel
      const panel = document.getElementById(`${tabName}-panel`);
      if (panel) {
        panel.classList.remove('hidden');
      }
      
      currentTab = tabName;
      
      // Load data for specific tabs
      if (tabName === 'scheduled') {
        loadScheduledItems();
      } else if (tabName === 'logs') {
        loadLogs();
      }
    };
    
    const handleKeyDown = (event, callback) => {
      if (event.key === 'Enter' || event.key === ' ') {
        event.preventDefault();
        callback();
      }
    };
    
    // ==================== API CALLS ====================
    
    const fetchData = async (url) => {
      try {
        const response = await fetch(url);
        if (!response.ok) throw new Error(`HTTP error! status: ${response. status}`);
        return await response.json();
      } catch (error) {
        console.error(`Error fetching ${url}:`, error);
        return null;
      }
    };
    
    const loadOverview = async () => {
      const [status, todayHoliday, upcomingHolidays] = await Promise.all([
        fetchData('/api/status'),
        fetchData('/api/holidays/today'),
        fetchData('/api/holidays/upcoming'),
      ]);
      
      if (status) {
        appState.status = status;
        updateStatusUI(status);
      }
      
      if (todayHoliday) {
        appState.todayHoliday = todayHoliday. holiday;
        updateTodayHolidayUI(todayHoliday. holiday);
      }
      
      if (upcomingHolidays && upcomingHolidays. holidays) {
        appState.upcomingHolidays = upcomingHolidays.holidays;
        updateUpcomingHolidaysUI(upcomingHolidays.holidays);
      }
    };
    
    const loadScheduledItems = async () => {
      const data = await fetchData('/api/announcements/scheduled');
      if (data && data.scheduled) {
        appState.scheduledItems = data.scheduled;
        updateScheduledUI(data.scheduled);
      }
    };
    
    const loadLogs = async () => {
      const data = await fetchData('/api/logs');
      if (data) {
        appState.logs = data;
        updateLogsUI(data);
      }
    };
    
    // ==================== UI UPDATES ====================
    
    const updateStatusUI = (status) => {
      // Status text
      const statusText = document.getElementById('status-text');
      if (statusText) {
        statusText. textContent = status.running ? 'RUNNING' : 'PAUSED';
      }
      
      // Timezone
      const timezoneText = document.getElementById('timezone-text');
      if (timezoneText && status.config) {
        timezoneText. textContent = `TZ: ${status.config.timezone || 'N/A'}`;
      }
      
      // Stats
      const holidayCount = document.getElementById('holiday-count');
      if (holidayCount) {
        holidayCount.textContent = status.totalHolidayAnnouncements || 0;
      }
      
      const customCount = document.getElementById('custom-count');
      if (customCount) {
        customCount.textContent = status.totalCustomAnnouncements || 0;
      }
      
      // Last run date
      const lastRunDate = document.getElementById('last-run-date');
      if (lastRunDate && status.state) {
        lastRunDate. textContent = status.state.lastRunDate || '‚Äî';
      }
    };
    
    const updateTodayHolidayUI = (holiday) => {
      const container = document.getElementById('today-holiday');
      if (! container) return;
      
      if (! holiday) {
        container.innerHTML = '<div class="text-cyan-300/60">NO_HOLIDAY_TODAY</div>';
        return;
      }
      
      container.innerHTML = `
        <div class="flex items-center justify-between p-4 bg-cyber-cyan/5 rounded-lg border border-cyber-cyan/30">
          <div>
            <div class="text-xl font-cyber font-bold glow-text mb-1">${holiday.name}</div>
            <div class="text-sm text-cyan-300/60">${holiday.description || holiday.type || ''}</div>
          </div>
          <div class="text-cyber-magenta font-bold text-lg">${holiday.date}</div>
        </div>
      `;
    };
    
    const updateUpcomingHolidaysUI = (holidays) => {
      const container = document.getElementById('upcoming-holidays');
      if (!container) return;
      
      if (! holidays || holidays.length === 0) {
        container.innerHTML = '<div class="text-cyan-300/60">NO_UPCOMING_HOLIDAYS</div>';
        return;
      }
      
      // Show next 30 days only
      const today = new Date();
      const next30Days = new Date(today. getTime() + 30 * 24 * 60 * 60 * 1000);
      const filteredHolidays = holidays. filter(h => {
        const holidayDate = new Date(h. date);
        return holidayDate >= today && holidayDate <= next30Days;
      });
      
      container.innerHTML = filteredHolidays.map(holiday => `
        <div class="flex items-center justify-between p-3 bg-cyber-cyan/5 rounded-lg border border-cyber-cyan/20 hover:border-cyber-cyan/50 transition-all">
          <div class="flex-1">
            <div class="font-bold text-cyan-200">${holiday.name}</div>
            <div class="text-xs text-cyan-300/60 mt-1">${holiday.description || holiday.type || ''}</div>
          </div>
          <div class="text-cyber-magenta font-bold text-sm ml-4">${holiday.date}</div>
        </div>
      `).join('');
    };
    
    const updateScheduledUI = (items) => {
      const container = document.getElementById('scheduled-list');
      if (!container) return;
      
      const scheduledCount = document.getElementById('scheduled-count');
      if (scheduledCount) {
        scheduledCount.textContent = items.length;
      }
      
      if (! items || items.length === 0) {
        container.innerHTML = '<div class="text-cyan-300/60">NO_SCHEDULED_ITEMS</div>';
        return;
      }
      
      container.innerHTML = items.map(item => `
        <div class="p-4 bg-cyber-cyan/5 rounded-lg border border-cyber-cyan/20">
          <div class="flex items-center justify-between mb-2">
            <span class="font-bold text-cyan-200">ID: ${item.id}</span>
            <span class="px-2 py-1 rounded text-xs ${
              item.status === 'scheduled' ? 'bg-cyber-yellow/20 text-cyber-yellow' :
              item.status === 'sent' ? 'bg-green-500/20 text-green-400' :
              'bg-red-500/20 text-red-400'
            }">${item.status. toUpperCase()}</span>
          </div>
          <div class="text-sm text-cyan-300/60">
            Scheduled: ${new Date(item.scheduleTime).toLocaleString()}
          </div>
        </div>
      `).join('');
    };
    
    const updateLogsUI = (logs) => {
      const container = document.getElementById('logs-container');
      if (!container) return;
      
      if (!logs || logs.length === 0) {
        container.innerHTML = '<div class="text-cyan-300/60">NO_LOGS_AVAILABLE</div>';
        return;
      }
      
      container.innerHTML = logs.slice(0, 100).map(log => {
        const typeColor = 
          log.type === 'ERROR' ? 'text-red-400' :
          log. type === 'SUCCESS' ? 'text-green-400' :
          log.type === 'WARNING' ?  'text-yellow-400' :
          'text-cyber-cyan';
        
        return `
          <div class="mb-2 pb-2 border-b border-cyber-cyan/10">
            <span class="text-cyan-300/60 text-xs">[${new Date(log.timestamp).toLocaleString()}]</span>
            <span class="${typeColor} font-bold text-xs ml-2">[${log.type}]</span>
            <div class="mt-1 text-cyan-200">${log.message}</div>
          </div>
        `;
      }).join('');
    };
    
    // ==================== ACTION HANDLERS ====================
    
    const handleTriggerHoliday = async (button) => {
      if (button.disabled) return;
      
      button.disabled = true;
      const originalText = button.innerHTML;
      button.innerHTML = '<div class="loading-spinner inline-block"></div> TRIGGERING...';
      
      try {
        const response = await fetch('/api/trigger/holiday', { method: 'POST' });
        const data = await response.json();
        
        if (data.success) {
          alert('‚úÖ Holiday check triggered successfully!\n\n' + (data.message || ''));
        } else {
          alert('‚ùå Failed to trigger holiday check:\n\n' + (data.message || data.error || 'Unknown error'));
        }
        
        await loadOverview();
      } catch (error) {
        alert('‚ùå Error:  ' + error.message);
      } finally {
        button.disabled = false;
        button.innerHTML = originalText;
      }
    };
    
    const handleTestNewYear = async (button) => {
      if (button.disabled) return;
      
      button.disabled = true;
      const originalText = button. innerHTML;
      button.innerHTML = '<div class="loading-spinner inline-block"></div> SENDING...';
      
      try {
        const response = await fetch('/api/test/newyear', { method: 'POST' });
        const data = await response.json();
        
        if (data.success) {
          alert('‚úÖ New Year test announcement sent successfully! ');
        } else {
          alert('‚ùå Failed to send test announcement:\n\n' + (data.error || 'Unknown error'));
        }
        
        await loadOverview();
      } catch (error) {
        alert('‚ùå Error: ' + error.message);
      } finally {
        button.disabled = false;
        button.innerHTML = originalText;
      }
    };
    
    const handleRefreshLogs = async () => {
      await loadLogs();
    };
    
    // ==================== INITIALIZATION ====================
    
    const init = () => {
      // Initialize canvas animations
      initSpaceCanvas();
      initMatrixCanvas();
      
      // Load initial data
      loadOverview();
      
      // Auto-refresh every 60 seconds
      setInterval(loadOverview, 60000);
    };
    
    // Start when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>
</html>
